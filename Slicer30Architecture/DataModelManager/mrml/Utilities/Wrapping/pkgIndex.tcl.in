# MRML Tcl package configuration.

namespace eval mrml {
  #
  # This procedure will help configure other MRML Tcl packages.
  # Call it with:
  #   package = the name of the package
  #   version = the version number of the package
  #
  proc ConfigureTclPackage {libName version} {
    set libPrefix "@CMAKE_SHARED_LIBRARY_PREFIX@"
    set libPath "@MRML_CSWIG_PACKAGE_DIR@"
    set libExt [info sharedlibextension]
    set libFile [file join $libPath "$libPrefix$libName$libExt"]
    set package [string tolower $libName]

    package ifneeded $package $version "
      namespace eval ::mrml::loader {
        set curDir \[pwd\]
        cd {$libPath}
        if {\[catch { load \"$libFile\" } errorMessage \]} { puts \$errorMessage }
        cd \$curDir
     }
    "
  }

  # Procedure to drive configuration of all packages.
  proc ConfigureMrmlTclPackages {version} {
    # Configure Mrml Tcl packages.
    ConfigureTclPackage MRMLTcl $version

    package ifneeded MRML $version "
      package require mrmltcl $version
      package provide MRML $version
    "
  }

  # Make sure the procedure can be called.
  namespace export ConfigureMrmlTclPackages
}

# Configure packages with version @MRML_VERSION_STRING@.
mrml::ConfigureMrmlTclPackages @MRML_VERSION_STRING@

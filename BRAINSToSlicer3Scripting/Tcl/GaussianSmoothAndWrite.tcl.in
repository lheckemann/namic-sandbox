######
# Need to source the BRAINS wrapper scripts.
update
source @COMMON_INCLUDE_SCRIPT@

#######
####### The Real Work

## Author Hans J. Johnson
proc TestGaussianSmoothAndWrite {} {
  set fileName @COMMON_DATA_DIR@/AVG_T1.nii.gz
  set inputImage [ b2_load_image ${fileName} ]
##set outputCopyFileName /Users/hjohnson/Desktop/NewCopyFile.nii.gz
  set outputCopyFileName @B2COMMANDTEST_BINARY_DIR@/NewCopyFile.nii.gz
  b2_save_image ${inputImage} ${outputCopyFileName}
######   Create Gaussian Image
  set GaussianImage [b2_gaussian_filter ${inputImage} ]
##set outputGaussianFileName /Users/hjohnson/Desktop/NewGaussianFile.nii.gz
  set outputGaussianFileName @B2COMMANDTEST_BINARY_DIR@/NewGaussianFile.nii.gz
  b2_save_image ${GaussianImage} ${outputGaussianFileName}

  ${inputImage} Delete
  ${GaussianImage} Delete
}

proc runtest {} {
      set ret [ catch {
                 $::slicer3::Application TraceScript TestGaussianSmoothAndWrite
                       } res]

#      set ff [open logger "w"]
#      puts $ff $ret $res
#      close $ff
      if { $ret } {
            puts stderr $res
            exit -1; #Failure
      }
      exit 0; #Success
}

update
after idle runtest

#DestroyBatchMRMLScene

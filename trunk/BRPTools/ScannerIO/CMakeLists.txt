PROJECT(ScannerSim)

INCLUDE (CheckIncludeFiles)

IF(CMAKE_SYSTEM_NAME STREQUAL "Darwin")
  ADD_DEFINITIONS(-DPLATFORM_OSX)
  IF(CMAKE_SYSTEM_VERSION MATCHES "9\\.[0-9]*\\.[0-9]*")
    ADD_DEFINITIONS(-DPLATFORM_OSX_LEOPARD)
  ENDIF(CMAKE_SYSTEM_VERSION MATCHES "9\\.[0-9]*\\.[0-9]*")
ENDIF(CMAKE_SYSTEM_NAME STREQUAL "Darwin")

IF(CMAKE_SYSTEM_NAME MATCHES Linux)
ADD_DEFINITIONS(-DPLATFORM_LINUX)
SET(LINUX 1)
SET(CMAKE_C_FLAGS -fPIC)
SET(CMAKE_CXX_FLAGS -fPIC)
ENDIF(CMAKE_SYSTEM_NAME MATCHES Linux)

IF(CMAKE_SYSTEM_NAME STREQUAL "Windows")
ADD_DEFINITIONS(-DPLATFORM_WIN32)
SET(WIN32 1)
ENDIF(CMAKE_SYSTEM_NAME STREQUAL "Windows")

INCLUDE_DIRECTORIES(
${CMAKE_CURRENT_SOURCE_DIR}/src/
${CMAKE_CURRENT_SOURCE_DIR}/src/igtlutil
libs/
)

ADD_DEFINITIONS(-DACE_AS_STATIC_LIBS)

OPTION(BUILD_SHARED "Build Shared Libraries" ON)

LINK_DIRECTORIES(
libs/ace
)

SET(SOURCES
src/ScannerBase.cxx
src/ScannerSim.cxx
src/igtlImage.cxx
src/igtlMath.cxx
src/igtlObject.cxx
src/igtlutil/igtl_util.c
src/igtlutil/igtl_header.c
src/igtlutil/igtl_image.c
src/igtlutil/igtl_transform.c
)

SUBDIRS(
libs/ace
)

IF(BUILD_SHARED)
ADD_LIBRARY(ScannerSimLib SHARED
${SOURCES}
)
ELSE(BUILD_SHARED)
ADD_LIBRARY(ScannerSimLib
${SOURCES}
)
ENDIF(BUILD_SHARED)

SET(LIBS
${LIBS}
ACE
)

IF(NOT WIN32)
SET(LIBS
${LIBS}
ncurses
pthread
dl
)
IF(LINUX)
SET(EXTRA_LIBS
rt
)
ENDIF(LINUX)
ENDIF(NOT WIN32)

TARGET_LINK_LIBRARIES(ScannerSimLib
${LIBS}
)

ADD_EXECUTABLE(ScannerSim src/main.cxx)

TARGET_LINK_LIBRARIES(ScannerSim
${EXTRA_LIBS}
ScannerSimLib
)

SET(EXECUTABLE_OUTPUT_PATH
bin
)



<?xml version="1.0" encoding="utf-8"?>
<executable>
  <category>
  HARDI Modules
  </category>
  <title>
  Diffusion ODF Estimation
  </title>
  <description>
  Performs a tensor model estimation from diffusion weighted images.
  There are three estimation methods available: least squares, weigthed least squares and non-linear estimation. The first method is the traditional method for tensor estimation and the fastest one. Weighted least squares takes into account the noise characteristics of the MRI images to weight the DWI samples used in the estimation based on its intensity magnitude. The last method is the more complex.
  </description>
  <version>0.1.0.$Revision: 1892 $(alpha)</version>
  <documentation-url></documentation-url>
  <license></license>
  <contributor>Luke Bloy</contributor>
  <acknowledgements>Cite Max's papers</acknowledgements>

  <parameters>
    <label>IO</label>
    <description>Input/output parameters</description>
    <image type="diffusion-weighted">
      <name>inputVolume</name>
      <label>Input DWI Volume</label>
      <channel>input</channel>
      <index>0</index>
      <description>Input DWI volume</description>
    </image>
    <image type="tensor">
      <name>outputODF</name>
      <label>Output ODF Volume</label>
      <channel>output</channel>
      <index>1</index>
      <description>Estimated ODF volume</description>
    </image>
    <image type ="scalar">
      <name>outputBaseline</name>
      <label>Output Baseline Volume</label>
      <channel>output</channel>
      <index>2</index>
      <description>Estimated baseline volume</description>
    </image>
    <image type ="label">
      <name>thresholdMask</name>
      <label>Otsu Threshold Mask</label>
      <channel>output</channel>
      <index>3</index>
      <description>Otsu Threshold Mask</description>
    </image> 
  </parameters>
  <parameters>
    <label>Estimation Parameters</label>
    <description> Parameters for the estimation algorithm</description>
    <integer>
      <name>order</name>
      <label>Maximum Order for RSH expansion</label>
      <flag>r</flag>
      <longflag>rshOrder</longflag>
      <description> </description>
      <default>4</default>
      <constraints>
      	<minimum>2</minimum>
	      <maximum>20</maximum>
	      <step>2</step>
      </constraints>
    </integer>
    <double>
      <name>faThreshold</name>
      <label>FA threshold</label>
      <flag>f</flag>
      <longflag>faThreshold</longflag>
      <description> The FA threshold is used to determine voxels with a "single" fiber population inorder to compute a fiber impulse response function</description>
      <default>.7</default>
      <constraints>
      	<minimum>0.1</minimum>
	      <maximum>1</maximum>
	      <step>0.05</step>
      </constraints>
    </double>
    <double>
      <name>beltramiLambda</name>
      <label>Beltrami smoothing factor</label>
      <flag>b</flag>
      <longflag>BeltramiLambda</longflag>
      <description>Controls the regulariaztion used in the Spherical Harmoinic fitting</description>
      <default>0.006</default>
      <constraints>
      	<minimum>0.00</minimum>
	      <maximum>0.01</maximum>
	      <step>0.0005</step>
      </constraints>
    </double>
    <double>
      <name>otsuOmegaThreshold</name>
      <label>Otsu Omega Threshold Parameter</label>
      <flag>o</flag>
      <longflag>otsuomegathreshold</longflag>
      <description>Control the sharpness of the threshold in the Otsu computation. 0: lower threshold, 1: higher threhold</description>
      <default>0.5</default>
      <constraints>
      	<minimum>0.0</minimum>
	      <maximum>1.0</maximum>
	      <step>0.1</step>
      </constraints>
    </double>
    <boolean>
     <name>removeIslands</name>
     <label>Remove Islands in Threshold Mask</label>
     <longflag>--removeislands</longflag>
     <description>Remove Islands in Threshold Mask?</description>
     <default>true</default>
    </boolean>
    <boolean>
     <name>applyMask</name>
     <label>Apply Mask to Tensor Image</label>
     <longflag>--applymask</longflag>
     <description>Apply Threshold Mask to ODF?</description>
     <default>true</default>
    </boolean>
  </parameters>
</executable>

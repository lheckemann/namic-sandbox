#
# $Id: CMakeLists.txt,v 1.12 2005/12/27 23:07:22 anton Exp $
#
# --- begin cisst license - do not edit ---
# 
# CISST Software License Agreement(c)
# 
# Copyright 2005 Johns Hopkins University (JHU) All Rights Reserved.
# 
# This software ("CISST Software") is provided by The Johns Hopkins
# University on behalf of the copyright holders and
# contributors. Permission is hereby granted, without payment, to copy,
# modify, display and distribute this software and its documentation, if
# any, for research purposes only, provided that (1) the above copyright
# notice and the following four paragraphs appear on all copies of this
# software, and (2) that source code to any modifications to this
# software be made publicly available under terms no more restrictive
# than those in this License Agreement. Use of this software constitutes
# acceptance of these terms and conditions.
# 
# The CISST Software has not been reviewed or approved by the Food and
# Drug Administration, and is for non-clinical, IRB-approved Research
# Use Only.
# 
# IN NO EVENT SHALL THE COPYRIGHT HOLDERS AND CONTRIBUTORS BE LIABLE TO
# ANY PARTY FOR DIRECT, INDIRECT, SPECIAL, INCIDENTAL, OR CONSEQUENTIAL
# DAMAGES ARISING OUT OF THE USE OF THIS SOFTWARE AND ITS DOCUMENTATION,
# EVEN IF THE COPYRIGHT HOLDERS AND CONTRIBUTORS HAVE BEEN ADVISED OF
# THE POSSIBILITY OF SUCH DAMAGE.
# 
# THE COPYRIGHT HOLDERS AND CONTRIBUTORS SPECIFICALLY DISCLAIM ANY
# EXPRESS OR IMPLIED WARRANTIES INCLUDING, BUT NOT LIMITED TO, THE
# IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR
# PURPOSE, AND NON-INFRINGEMENT.
# 
# THE SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
# IS." THE COPYRIGHT HOLDERS AND CONTRIBUTORS HAVE NO OBLIGATION TO
# PROVIDE MAINTENANCE, SUPPORT, UPDATES, ENHANCEMENTS, OR MODIFICATIONS.
# 
# --- end cisst license ---


# Backward compatibility
CMAKE_MINIMUM_REQUIRED(VERSION 2.0)
PROJECT(cisstDocDoxygen)


# Check for basic tools
FIND_PACKAGE(Doxygen)


# Install only required files
FOREACH(lib ${CISST_LIBRARIES})
  SET(CISST_DOXYGEN_LIBRARIES_INCLUDE
      "${CISST_DOXYGEN_LIBRARIES_INCLUDE} ${cisst_SOURCE_DIR}/libs/include/${lib}")
ENDFOREACH(lib)


# Configure the input file for Doxygen
SET(CISST_DOXYGEN_INPUT_PATH ${cisstDocDoxygen_SOURCE_DIR})
SET(CISST_DOXYGEN_OUTPUT_PATH ${cisstDocDoxygen_BINARY_DIR})

CONFIGURE_FILE(${cisstDocDoxygen_SOURCE_DIR}/cisst.doxygen-config.in
               ${cisstDocDoxygen_BINARY_DIR}/cisst.doxygen-config
               @ONLY@)

# Build the list of header files
SET(ALL_HEADERS ${cisstDocDoxygen_SOURCE_DIR}/main.dox)
FOREACH(lib ${CISST_LIBRARIES})
  FILE(GLOB LIB_HEADERS ${cisst_SOURCE_DIR}/libs/include/${lib}/*.h)
  SET(ALL_HEADERS ${ALL_HEADERS} ${LIB_HEADERS})
ENDFOREACH(lib)

# Run Doxygen if any header file has been modified
ADD_CUSTOM_TARGET(${cisstDocDoxygen_BINARY_DIR}/html/index.html
                  ALL
                  ${DOXYGEN}
                  ${cisstDocDoxygen_BINARY_DIR}/cisst.doxygen-config
                  DEPENDS ${ALL_HEADERS})

# Install the pdf file
INSTALL_FILES(/share/cisst/doc/doxygen
              ".html"
              ${cisstDocDoxygen_BINARY_DIR}/html/index.html)

# Install the html files generated
CONFIGURE_FILE(${CMAKE_CURRENT_SOURCE_DIR}/postInstall.cmake.in
               ${cisstDocDoxygen_BINARY_DIR}/postInstall.cmake
               @ONLY)

SET_TARGET_PROPERTIES(${cisstDocDoxygen_BINARY_DIR}/html/index.html
                      PROPERTIES POST_INSTALL_SCRIPT
                      ${cisstDocDoxygen_BINARY_DIR}/postInstall.cmake)


#
# $Log: CMakeLists.txt,v $
# Revision 1.12  2005/12/27 23:07:22  anton
# Doxygen CMakeLists: Added dependencies on header files.
#
# Revision 1.11  2005/12/23 21:28:38  anton
# Doxygen CMakeLists.txt: Removed compilation of pdf.
#
# Revision 1.10  2005/09/07 07:08:58  anton
# Doc: Updated all CMakeLists work with ./CMakeLists.txt, added license,
# corrected couple of issues re. CMake 2.0+.
#
# Revision 1.9  2004/09/17 19:27:58  anton
# install process:  Finally succeded at having "make install" to install
# files generated by Doxygen and LaTeX2Html without having to type
# "make install_html".  This closes the ticket #40.
#
# Revision 1.8  2004/09/03 20:03:50  anton
# CMake for documentation: Since version 2.0 of CMake, we should be able to
# add a CMake script to install multiple files.  Until now, we had to use
# "make install; make install_html" to install everything.  Unfortunately,
# this new feature of CMake seems buggy.  I am commiting these changes in
# order to keep track of my attempts and hopefully the CMake team will
# reply to my bug/feature requests.  See ticket #40.
#
# Revision 1.7  2004/01/22 22:00:53  anton
# Removed dependency on CISST_ALL_HEADER
#
# Revision 1.6  2003/10/15 16:12:01  anton
# use CISST_DOXYGEN_DIR, not CISST_INCLUDE_DIR which can contain multiple dirs
#
# Revision 1.5  2003/10/08 13:37:02  anton
# Removed ADD_CUSTOM_COMMAND since ADD_CUSTOM_TARGET now handles DEPENDS correctly (cmake 1.8.1)
#
# Revision 1.4  2003/09/12 20:04:23  anton
# add install_html target, moved FindLATEX and FindUnixCommands up to factorize
#
# Revision 1.3  2003/08/28 13:10:35  anton
# Changed CISST_DOXYGEN_LIBRARIES_INCLUDE to a string with double quotes to avoid the \;
#
# Revision 1.2  2003/08/08 18:45:57  anton
# Now compile the pdf file and install it
#
# Revision 1.1  2003/08/06 13:55:07  anton
# Creation
#
#

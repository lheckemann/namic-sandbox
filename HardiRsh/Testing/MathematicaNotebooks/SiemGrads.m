(* ::Package:: *)

LoadSiemGrads64 := {{1.000000,0.000000,0.000000},{0.000000,1.000000,0.000000},{-0.026007,0.649170,0.760199},{0.591136,-0.766176,0.252058},{-0.236071,-0.524158,0.818247},{-0.893021,-0.259006,0.368008},{0.796184,0.129030,0.591137},{0.233964,0.929855,0.283956},{0.935686,0.139953,0.323891},{0.505827,-0.844710,-0.174940},{0.346220,-0.847539,-0.402256},{0.456968,-0.630956,-0.626956},{-0.486997,-0.388997,0.781995},{-0.617845,0.672831,0.406898},{-0.576984,-0.104997,-0.809978},{-0.826695,-0.520808,0.212921},{0.893712,-0.039987,-0.446856},{0.290101,-0.541189,-0.789276},{0.115951,-0.962591,-0.244896},{-0.800182,0.403092,-0.444101},{0.513981,0.839970,0.173994},{-0.788548,0.152912,-0.595659},{0.949280,-0.233069,0.211062},{0.232964,0.782880,0.576911},{-0.020999,-0.187990,-0.981946},{0.216932,-0.955701,0.198938},{0.774003,-0.604002,0.190001},{-0.160928,0.355840,0.920587},{-0.147035,0.731173,-0.666158},{0.888141,0.417066,0.193031},{-0.561971,0.231988,-0.793959},{-0.380809,0.142928,0.913541},{-0.306000,-0.199000,-0.931001},{-0.332086,-0.130034,0.934243},{-0.963226,-0.265062,0.044010},{-0.959501,0.205107,0.193101},{0.452965,-0.888932,0.067995},{-0.773133,0.628108,0.088015},{0.709082,0.408047,0.575066},{-0.692769,0.023992,0.720760},{0.681659,0.528735,-0.505747},{-0.141995,-0.724976,0.673978},{-0.740168,0.388088,0.549125},{-0.103006,0.822044,0.560030},{0.584037,-0.596038,0.551035},{-0.088008,-0.335031,0.938088},{-0.552263,-0.792377,0.259123},{0.838158,-0.458086,-0.296056},{0.362995,-0.560993,0.743990},{-0.184062,0.392133,-0.901306},{-0.720938,-0.692941,0.008999},{0.433101,0.682159,-0.589137},{0.502114,0.690157,0.521119},{-0.170944,-0.508833,-0.843722},{0.462968,0.422971,0.778946},{0.385030,-0.809064,0.444035},{-0.713102,-0.247035,0.656094},{0.259923,0.884737,-0.386885},{0.001000,0.077002,-0.997030},{0.037002,-0.902057,0.430027},{0.570320,-0.303170,-0.763428},{-0.282105,0.145054,-0.948354},{0.721098,0.608082,0.332045},{0.266985,0.959945,-0.084995}};


LoadSiemGrads128 := { { -0.4510393848, 0.8415390163, -0.2972802674 },{ 0.1004315513, -0.8129843816, 0.5735589759 },{ -0.9576858273, 0.2342075637, -0.1672862015 },{ -0.4918238897, -0.0360032411, -0.8699500147 },{ -0.7029891673, 0.4166890858, 0.5763474963 },{ -0.7510325238, 0.1784135102, 0.6357033645 },{ -0.1986148102, -0.2827946081, -0.9383919047 },{ -0.0252493219, 0.4881336677, -0.8724035730 },{ 0.5254610507, -0.5285181094, -0.6667527969 },{ -0.8502890096, -0.4952822985, 0.1780562971 },{ 0.2521286814, 0.1969268644, -0.9474444248 },{ 0.6174821981, -0.0637769892, -0.7839950451 },{ -0.8472958270, -0.3276187482, -0.4180379617 },{ 0.6301554272, 0.7760144704, 0.0265646243 },{ -0.3682409245, 0.9155614285, 0.1616969144 },{ -0.1985974210, 0.9800563404, -0.0069738079 },{ -0.5203035632, -0.4290717229, -0.7383641776 },{ 0.1146323058, 0.8051229141, -0.5819248470 },{ -0.2230080233, 0.7806182945, 0.5838685639 },{ -0.6803549098, -0.0123779513, -0.7327782632 },{ -0.1828448589, -0.6980367271, -0.6923239742 },{ -0.0744716604, 0.9030107776, 0.4231140594 },{ 0.3546224458, 0.8994139743, -0.2555336061 },{ 0.4212248869, 0.2529756626, 0.8709609112 },{ 0.2709983488, 0.0733073255, 0.9597843148 },{ 0.5889088901, -0.3052806692, -0.7483248173 },{ 0.8008507836, -0.3249365622, 0.5030449810 },{ -0.6223173465, 0.4030276605, -0.6710363814 },{ -0.2899824236, 0.6987459677, -0.6539604473 },{ -0.1406160824, 0.1044064251, -0.9845437602 },{ -0.1523850513, -0.6227682478, 0.7674232898 },{ 0.5724903703, -0.8147535446, -0.0918228590 },{ 0.2493568457, -0.9399299416, 0.2331370164 },{ -0.3571058278, 0.1533621375, -0.9213878025 },{ -0.5541604556, -0.8052453430, 0.2109173464 },{ -0.4230685413, 0.3732460806, -0.8256514838 },{ -0.5203205118, -0.6076932555, 0.5999795599 },{ -0.4364815630, 0.1807056326, 0.8813792143 },{ -0.8886129140, -0.1762604958, 0.4234375121 },{ -0.2092218639, 0.2575007897, 0.9433554765 },{ 0.9878151649, 0.1556157394, 0.0022230019 },{ -0.6909608924, 0.5303131275, -0.4912647270 },{ 0.4334654806, -0.7240157075, -0.5365714606 },{ -0.2972615560, -0.4578130309, -0.8378799413 },{ -0.6927163062, -0.4836558892, 0.5349963551 },{ -0.4520490895, -0.0652724455, 0.8896016684 },{ 0.3725125635, 0.7610351019, 0.5310931780 },{ 0.8822878957, -0.4622273094, 0.0889605726 },{ -0.9144486333, -0.0981388014, -0.3926225577 },{ -0.2000004123, -0.9736986516, 0.1091364786 },{ -0.3339252017, -0.8826638022, -0.3307545493 },{ 0.7895162682, 0.1762912003, 0.5878651844 },{ 0.9149351631, -0.1570389721, 0.3717961923 },{ -0.1001375322, -0.9550294420, -0.2790900206 },{ -0.0007326823, -0.7922433372, -0.6102048491 },{ -0.0782468466, 0.9193984505, -0.3854658483 },{ -0.7229924391, -0.6743332917, 0.1501883643 },{ -0.6219590613, -0.1711928965, 0.7641072689 },{ 0.9377668728, 0.2854290403, -0.1977967525 },{ 0.8071391116, 0.5885063033, 0.0467630780 },{ 0.5794356596, 0.3950855117, -0.7128546519 },{ -0.5701129439, -0.5965256439, -0.5649144956 },{ 0.4716100660, -0.5542536297, 0.6858475483 },{ -0.0624247987, 0.6708688680, -0.7389439130 },{ -0.6233267711, 0.6966972093, -0.3550728585 },{ 0.5536255230, -0.1893976797, 0.8109422293 },{ 0.1365577060, 0.9257953815, -0.3524980914 },{ 0.3189561260, 0.6990299254, -0.6400188693 },{ -0.3227365856, 0.6129356209, 0.7212149617 },{ 0.8461828764, -0.2724999931, -0.4579500993 },{ 0.1691547839, 0.8584163590, 0.4842602747 },{ -0.0173761412, -0.1391857191, -0.9901138345 },{ -0.3137298406, -0.8290958496, 0.4627890008 },{ -0.9456223318, -0.2446384813, -0.2143604884 },{ 0.2639461730, -0.0482837131, -0.9633281376 },{ 0.3819639450, 0.6075543921, 0.6964059200 },{ -0.4164013428, 0.9067767579, -0.0660744507 },{ 0.5181168379, 0.7429547809, -0.4237607059 },{ -0.7763361978, -0.0495303106, 0.6283699995 },{ 0.2522076403, -0.5320847620, 0.8082555984 },{ 0.6997978544, 0.6163269343, -0.3611427322 },{ 0.8900531575, -0.0467168641, -0.4534566258 },{ -0.7454552987, 0.6664174141, -0.0135730502 },{ 0.2683265077, 0.9560968057, 0.1178124927 },{ 0.1427631730, -0.9660277742, -0.2154275190 },{ -0.6199469122, 0.6302283900, 0.4674163054 },{ 0.7696696775, -0.5910380012, 0.2414180372 },{ -0.6980015233, -0.6791150427, -0.2271489211 },{ -0.7201477782, 0.2018317376, -0.6638155822 },{ 0.7020720351, 0.3958160137, 0.5919666720 },{ -0.9238650433, -0.3821090907, -0.0215876048 },{ 0.6950097805, -0.6799821159, -0.2336358855 },{ -0.8977869675, 0.3569227171, 0.2580401810 },{ 0.3033207933, -0.8731930799, -0.3814843923 },{ 0.4279604984, 0.2983692512, -0.8531269552 },{ 0.1834520677, -0.4777296877, -0.8591389203 },{ 0.8527832860, 0.4670302818, 0.2337592413 },{ 0.8343388401, 0.3967161936, -0.3827466023 },{ -0.9711141604, -0.0707901404, 0.2278728668 },{ -0.3780380598, -0.5133210681, 0.7704470821 },{ 0.4966825161, 0.8472843307, 0.1881907043 },{ 0.0882731033, -0.6504807096, -0.7543757059 },{ 0.8346067192, -0.0494090490, 0.5486258928 },{ 0.0342653384, 0.9975912783, 0.0603119221 },{ -0.8611825770, 0.4000036631, -0.3136265912 },{ 0.5492296646, 0.7407857372, 0.3867599606 },{ -0.0052019520, 0.3644959249, 0.9311904534 },{ 0.6077405127, -0.7820241959, 0.1381652138 },{ -0.7295989024, -0.5466807040, -0.4108839855 },{ 0.0922737101, 0.5427863458, 0.8347865267 },{ 0.9540183275, -0.2955897489, -0.0497567186 },{ -0.3927116077, 0.4008481036, 0.8277067059 },{ -0.0746903668, -0.0554496104, 0.9956639442 },{ 0.3006901374, -0.8366131055, 0.4578907653 },{ -0.4298311117, -0.9023448556, 0.0319214186 },{ -0.9971453365, 0.0714293217, 0.0244750884 },{ -0.5127442226, 0.7960907941, 0.3214542109 },{ -0.2040435067, -0.4196568726, 0.8844514439 },{ -0.0239297006, -0.2819249154, 0.9591380044 },{ 0.2049103071, -0.3314884680, 0.9209381964 },{ -0.8397965383, 0.5273498835, 0.1290111416 },{ 0.0209789354, -0.9854987329, 0.1683809128 },{ 0.7769141833, -0.5067546111, -0.3736363418 },{ 0.7588477752, 0.2714021533, -0.5920227405 },{ 0.9567510992, -0.1437649831, -0.2529010947 },{ 0.6211852582, 0.2258997803, 0.7503986702 },{ 0.4892525086, -0.6983972410, 0.5223727373 },{ 0.9807234060, 0.0024957510, 0.1953851891 }}


LoadSiemGrads256 := {{0.059010,-0.013002,0.998173},{0.070008,0.157018,0.985111},{-0.078038,0.083041,0.993486},{-0.092987,-0.086988,0.991860},{0.046987,-0.178952,0.982735},{0.199944,-0.108970,0.973729},{0.211021,0.052005,0.976097},{0.210999,0.212999,0.953997},{-0.050982,0.250913,0.966666},{-0.208056,0.186050,0.960259},{-0.355044,0.120015,0.927114},{-0.225050,0.016004,0.974216},{-0.239998,-0.156999,0.957994},{-0.107055,-0.253129,0.961491},{0.031988,-0.337873,0.940648},{0.191053,-0.268075,0.944264},{0.333011,-0.202007,0.921030},{0.350043,-0.034004,0.936116},{0.353962,0.131986,0.925900},{0.321087,0.303082,0.897243},{0.124035,0.337095,0.933264},{-0.028007,0.395092,0.918214},{-0.189921,0.343856,0.919616},{-0.340929,0.281942,0.896814},{-0.483028,0.214012,0.849048},{-0.492017,0.052002,0.869031},{-0.364886,-0.049984,0.929710},{-0.376988,-0.226993,0.897972},{-0.251019,-0.327024,0.911068},{-0.116041,-0.415148,0.902323},{0.027007,-0.490130,0.871231},{0.176089,-0.413208,0.893450},{0.323985,-0.380982,0.865960},{0.451026,-0.272016,0.850049},{0.477203,-0.106045,0.872371},{0.487906,0.059988,0.870832},{0.468001,0.231001,0.853003},{0.426147,0.394136,0.814282},{0.266963,0.442939,0.855883},{0.120952,0.485807,0.865657},{-0.024989,0.534766,0.844631},{-0.176029,0.491082,0.853142},{-0.323126,0.437171,0.839328},{-0.463978,0.371982,0.803961},{-0.613900,0.139977,0.776874},{-0.617975,-0.018999,0.785968},{-0.493054,-0.117013,0.862094},{-0.503790,-0.292878,0.812661},{-0.383865,-0.394861,0.834705},{-0.253926,-0.486859,0.835757},{-0.113952,-0.565762,0.816657},{0.037997,-0.625950,0.778937},{0.182983,-0.543949,0.818924},{0.328974,-0.543956,0.771938},{0.446988,-0.437988,0.779979},{0.565718,-0.320840,0.759621},{0.595011,-0.163003,0.787015},{0.611304,-0.002001,0.791393},{0.600103,0.163028,0.783134},{0.568061,0.325035,0.756081},{0.512003,0.482003,0.711004},{0.362192,0.543287,0.757401},{0.211049,0.594139,0.776181},{0.058967,0.640642,0.765572},{-0.119057,0.637302,0.761361},{-0.274102,0.590219,0.759282},{-0.421992,0.527990,0.736986},{-0.560010,0.454008,0.693012},{-0.598017,0.298008,0.744021},{-0.730015,0.044001,0.682014},{-0.718931,-0.123988,0.683934},{-0.607904,-0.181971,0.772878},{-0.643781,-0.311894,0.698762},{-0.524667,-0.433725,0.732535},{-0.395115,-0.537156,0.745217},{-0.255897,-0.624749,0.737703},{-0.106010,-0.694064,0.712066},{0.051982,-0.740746,0.669771},{0.198017,-0.665057,0.720062},{0.338997,-0.682994,0.646994},{0.455869,-0.583832,0.671807},{0.567210,-0.477177,0.671249},{0.670100,-0.360054,0.649097},{0.704211,-0.210063,0.678203},{0.723245,-0.057019,0.688233},{0.720289,0.101041,0.686276},{0.696042,0.258015,0.670040},{0.650084,0.411053,0.639082},{0.582844,0.557851,0.590842},{0.441061,0.629087,0.640089},{0.292091,0.685213,0.667208},{0.136935,0.732653,0.666684},{-0.035006,0.744130,0.667117},{-0.207001,0.724004,0.658004},{-0.361776,0.671585,0.646600},{-0.506971,0.602966,0.615965},{-0.641109,0.517088,0.567097},{-0.690897,0.366945,0.622907},{-0.718746,0.206927,0.663766},{-0.821800,0.110973,0.558864},{-0.820917,-0.048995,0.568942},{-0.787722,-0.210926,0.578796},{-0.733198,-0.353096,0.581157},{-0.632761,-0.470822,0.614768},{-0.516033,-0.577036,0.633040},{-0.386042,-0.669073,0.635069},{-0.244127,-0.745387,0.620322},{-0.092982,-0.802848,0.588888},{0.061971,-0.837608,0.542746},{0.207049,-0.774182,0.598141},{0.355042,-0.784093,0.509061},{0.480125,-0.691179,0.540140},{0.596018,-0.585017,0.550016},{0.703421,-0.465279,0.537322},{0.781234,-0.304091,0.545163},{0.812165,-0.145029,0.565115},{0.821641,0.016993,0.569751},{0.808928,0.175984,0.560950},{0.774726,0.330883,0.538810},{0.718831,0.477888,0.504881},{0.642730,0.615741,0.455808},{0.509022,0.697030,0.505021},{0.366176,0.758364,0.539259},{0.213039,0.808148,0.549100},{0.045984,0.830708,0.554805},{-0.123006,0.826039,0.550026},{-0.288131,0.793361,0.536244},{-0.439982,0.734970,0.515979},{-0.579687,0.658644,0.479741},{-0.705004,0.567003,0.426002},{-0.764589,0.424772,0.484740},{-0.800709,0.269902,0.534806},{-0.892958,0.161992,0.419980},{-0.900927,0.002000,0.433965},{-0.879831,-0.158969,0.447914},{-0.833019,-0.319007,0.452010},{-0.747071,-0.470045,0.470045},{-0.637748,-0.587767,0.497803},{-0.513898,-0.689863,0.509899},{-0.377037,-0.775076,0.507050},{-0.230976,-0.842913,0.485950},{-0.081983,-0.889811,0.448905},{0.074014,-0.912169,0.403075},{0.219092,-0.860361,0.460193},{0.362034,-0.861080,0.357033},{0.490041,-0.778065,0.393033},{0.608025,-0.678028,0.413017},{0.718996,-0.558997,0.412998},{0.810079,-0.408040,0.421041},{0.870877,-0.239966,0.428940},{0.894955,-0.073996,0.439978},{0.896096,0.088009,0.435047},{0.874684,0.243912,0.418849},{0.831860,0.391934,0.392934},{0.768978,0.530985,0.355990},{0.687097,0.657093,0.310044},{0.564702,0.745606,0.353813},{0.432080,0.812149,0.392072},{0.286963,0.863887,0.413946},{0.126973,0.895811,0.425910},{-0.039977,0.903483,0.426756},{-0.206046,0.885199,0.417094},{-0.364892,0.841750,0.397882},{-0.510950,0.775924,0.369964},{-0.639907,0.695898,0.325952},{-0.753755,0.597806,0.272911},{-0.818055,0.471032,0.330022},{-0.862916,0.318969,0.391962},{-0.938282,0.216065,0.270081},{-0.956045,0.055003,0.288014},{-0.946681,-0.106964,0.303898},{-0.909812,-0.267945,0.316935},{-0.839417,-0.429702,0.332769},{-0.741292,-0.573226,0.349138},{-0.624959,-0.687955,0.368976},{-0.493966,-0.784946,0.373974},{-0.353977,-0.861944,0.362977},{-0.211958,-0.918819,0.332934},{-0.066965,-0.953504,0.293847},{0.084956,-0.963501,0.253868},{0.228069,-0.924279,0.306092},{0.333060,-0.925167,0.182033},{0.466929,-0.853870,0.229965},{0.595385,-0.760492,0.259168},{0.709740,-0.647763,0.276899},{0.814356,-0.503220,0.289126},{0.892778,-0.337916,0.297926},{0.938954,-0.162992,0.302985},{0.954223,0.004001,0.299070},{0.944039,0.166007,0.285012},{0.909805,0.321931,0.261944},{0.852595,0.469777,0.228891},{0.771212,0.608168,0.188052},{0.644272,0.742313,0.184078},{0.512029,0.830048,0.221013},{0.371982,0.891957,0.256988},{0.218003,0.934014,0.283004},{0.147000,0.978001,0.148000},{0.050005,0.955101,0.292031},{-0.120044,0.950347,0.287105},{-0.287133,0.918424,0.272126},{-0.444757,0.861529,0.244866},{-0.582982,0.786976,0.201994},{-0.707118,0.690116,0.154026},{-0.823874,0.547916,0.144978},{-0.895869,0.373945,0.239965},{-0.956936,0.266982,0.113992},{-0.984969,0.108997,0.133996},{-0.987109,-0.053006,0.151017},{-0.962464,-0.213103,0.168081},{-0.907966,-0.372986,0.190993},{-0.822992,-0.528995,0.206998},{-0.712235,-0.666220,0.221073},{-0.584746,-0.777662,0.230900},{-0.445210,-0.866409,0.226107},{-0.302832,-0.932484,0.196891},{-0.155030,-0.975188,0.158031},{0.003001,-0.992396,0.123049},{-0.105043,0.994407,0.011005},{0.184970,-0.973842,0.131979},{0.279071,-0.960245,0.007002},{0.426883,-0.902753,0.052986},{0.560256,-0.822376,0.099045},{0.687169,-0.716176,0.122030},{0.794057,-0.589042,0.150011},{0.887491,-0.430238,0.165091},{0.951729,-0.254927,0.170951},{0.983436,-0.085038,0.160071},{0.985899,0.079992,0.146985},{0.961934,0.241983,0.126991},{0.912643,0.396845,0.097962},{0.837257,0.543167,0.063019},{0.723919,0.687923,0.051994},{0.588089,0.807122,0.052008},{0.450862,0.888729,0.082975},{0.304931,0.944787,0.119973},{-0.233066,-0.972275,0.019005},{0.073019,0.997258,0.012003},{-0.026001,0.988038,0.152006},{-0.200088,0.969424,0.142062},{-0.365992,0.922979,0.118997},{-0.510695,0.856488,0.074955},{-0.640958,0.766950,0.030998},{-0.764977,0.643980,0.010000},{0.857996,-0.512998,0.026000},{-0.901024,0.423011,0.096003},{0.938499,-0.343182,0.038020},{0.983769,-0.177958,0.022995},{0.999898,-0.012999,0.005999},{-0.988633,-0.149944,0.010996},{-0.949788,-0.310931,0.034992},{-0.883406,-0.464213,0.064029},{-0.783923,-0.615940,0.077992},{-0.660104,-0.746118,0.087014},{-0.521822,-0.848711,0.085971},{-0.380935,-0.922844,0.056990}};


 (**
   * uses the formula in [saff:dmp:1997] to generate equidistributed points on the sphere.
   * 
   * REFERENCE
   * @Article{saff:dmp:1997,
   * author =          {Saff, E. B. and Kuijlaars, A. B. J.},
   * title =          {Distributing Many Points on a Sphere},
   * journal =          {Math. Intell.},
   * year =          {1997},
   * volume =          {19},
   * number =          {1},
   * pages =          {5--11},
   *
X = zeros (N,3);

for k=1:N
  h = -1 + 2*(k-1)/(N-1);
  theta (k) = acos (h);
  if k==1 | k==N 
    phi (k) = 0;
  else 
    phi (k) = mod (phi (k-1) + 3.6/sqrt(N*(1-h^2)),2*pi);
  end;
  X (k,:) = [ cos (phi (k))*sin (theta (k)), ...
	     sin (phi (k))*sin (theta (k)), ...
	     cos (theta (k)) ];
end;
*)
LoadEquidistGrads[NGrads_] := Module[{grads,k,h,lastPhi,phi,theta},
	grads = Array[0&,{NGrads,3}];
	For[k=1,k<=NGrads,k++,
		h = -1 + 2*(k-1)/(NGrads-1);
        theta = ArcCos[h]//N;
	    If[k==1 || k==NGrads , phi=0, phi = Mod[lastPhi + 3.6/Sqrt[(NGrads*(1-h^2))],2*Pi];];
	    lastPhi = phi;
		grads[[k,All]] = {Cos[phi]Sin[theta],Sin[phi]Sin[theta],Cos[theta]};
	];
	Return[grads];
];


\documentclass{InsightArticle}

\usepackage[dvips]{graphicx}
\usepackage{color}
\usepackage{listings}

\definecolor{listcomment}{rgb}{0.0,0.5,0.0}
\definecolor{listkeyword}{rgb}{0.0,0.0,0.5}
\definecolor{listnumbers}{gray}{0.65}
\definecolor{listlightgray}{gray}{0.955}
\definecolor{listwhite}{gray}{1.0}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  hyperref should be the last package to be loaded.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage[dvips,
bookmarks,
bookmarksopen,
backref,
colorlinks,linkcolor={blue},citecolor={blue},urlcolor={blue},
]{hyperref}


\title{Spherical Demons Registration\\ of Spherical Surfaces}


% 
% NOTE: This is the last number of the "handle" URL that 
% The Insight Journal assigns to your paper as part of the
% submission process. Please replace the number "1338" with
% the actual handle number that you get assigned.
%
\newcommand{\IJhandlerIDnumber}{1338}

\lstset{frame = tb,
       framerule = 0.25pt,
       float,
       fontadjust,
       backgroundcolor={\color{listlightgray}},
       basicstyle = {\ttfamily\footnotesize},
       keywordstyle = {\ttfamily\color{listkeyword}\textbf},
       identifierstyle = {\ttfamily},
       commentstyle = {\ttfamily\color{listcomment}\textit},
       stringstyle = {\ttfamily},
       showstringspaces = false,
       showtabs = false,
       numbers = left,
       numbersep = 6pt,
       numberstyle={\ttfamily\color{listnumbers}},
       tabsize = 2,
       language=[ANSI]C++,
       floatplacement=!h
       }



\release{1.00}

\author{Luis Ibanez$^{1}$, Michel Audette$^{1}$, Thomas Yeo$^{1}$, Polina Goland$^{2}$}
\authoraddress{$^{1}$Kitware Inc., Clifton Park, NY\\
               $^{2}$CSAIL MIT, Boston, MA}

\begin{document}


%
% Add hyperlink to the web location and license of the paper.
% The argument of this command is the handler identifier given
% by the Insight Journal to this paper.
% 
\IJhandlefooter{\IJhandlerIDnumber}


\ifpdf
\else
   %
   % Commands for including Graphics when using latex
   % 
   \DeclareGraphicsExtensions{.eps,.jpg,.gif,.tiff,.bmp,.png}
   \DeclareGraphicsRule{.jpg}{eps}{.jpg.bb}{`convert #1 eps:-}
   \DeclareGraphicsRule{.gif}{eps}{.gif.bb}{`convert #1 eps:-}
   \DeclareGraphicsRule{.tiff}{eps}{.tiff.bb}{`convert #1 eps:-}
   \DeclareGraphicsRule{.bmp}{eps}{.bmp.bb}{`convert #1 eps:-}
   \DeclareGraphicsRule{.png}{eps}{.png.bb}{`convert #1 eps:-}
\fi


\maketitle


\ifhtml
\chapter*{Front Matter\label{front}}
\fi


\begin{abstract}
\noindent
This document describes a contribution to the Insight Toolkit intended to
support the process of performing deformable registration on two Meshes. The
method implemented here is restricted to Meshes with a Spherical geometry and
topology, and with scalar values associated to their nodes. The code described
here is an implementation of the paper ``\emph{Spherical Demons: Fast
Diffeomorphic Landmark-Free Surface Registration}'' by Yeo, Sabuncu,
Vercauteren, Ayache, Fischl and Golland~\cite{Yeo2008,Yeo2009}.

This paper is accompanied with the source code, input data, parameters and
output data that we used for validating the algorithm described in this paper.
This adheres to the fundamental principle that scientific publications must
facilitate \textbf{reproducibility} of the reported results.
\end{abstract}

\tableofcontents

\section{Introduction}

The method described in this paper is the Mesh equivalent of the Demons
Deformable registration method implemented for images that is currently
available in the Insight Toolkit.

For example

\begin{itemize}
\item \doxygen{DemonsRegistrationFilter}
\item \doxygen{FastSymmetricForcesDemonsRegistrationFunction}
\item \doxygen{DiffeomorphicDemonsRegistrationFilter}
\end{itemize}

The method implemented here is restricted to the case of two Meshes with
spherical geometry and topology, with scalar values associated to their nodes.
The registration operates on the scalar values, not on the geometry of the mesh
surface.

This contribution is the third on a series of papers related to improving
support for mesh registration in the Insight Toolkit. Previous papers have
covered the topics of rigid registration on Meshes and iterative smoothing of
meshes with scalar and vector field
values~\cite{MeshSmoothingIJ2009,MeshRigidRegistrationIJ2009} 

\section{How to Build}

This contribution includes

\begin{itemize}
\item Source code of the Spherical Diffeomorphic Demons filter
\item Tests for the filter
\item Examples on how to use the filter
\item All the LaTeX source files of this paper
\end{itemize}

\subsection{Building Executables and Tests}

In order to build the whole, it is enough to configure the directory with
CMake. As usual, an out-of-source build is the recommended method.

In a Linux environment it should be enough to do the following:

\begin{itemize}
\item \code{ccmake  SOURCE\_DIRECTORY}
\item \code{make}
\item \code{ctest}
\end{itemize}

Where SOURCE\_DIRECTORY is the directory where you have expanded the source
code that accompanies this paper.

This will configure the project, build the executables, and run the tests and
examples. 


\subsection{Building this Report}

In order to build this report you can do

\begin{itemize}
\item \code{ccmake SOURCE\_DIRECTORY}
\item Turn ON the CMake variable
\begin{itemize}
\item \code{BUILD\_REPORTS}
\end{itemize}
\item \code{make}
\end{itemize}

This should produce a PDF file in the binary directory, under the subdirectory
\code{Documents/Report001}.

\section{How to Use the Filter}

This section illustrates the minimum operations required for running these two
filters. The code shown here is available in the Examples directory of the code
that accompanies this paper. You can download the entire set of files from the
Insight Journal web site.

It is assumed that you would have already performed Rigid registration between
the two meshes before you attempt to perform Deformable registration using the
filter described below.


\subsection{Basic Registration Example}

In order to use this filter we should start by including headers for the Demons
registration filter, the reader and writer types and the \doxygen{QuadEdgeMesh}
itself.

\begin{center}
\lstinputlisting[linerange={21-24}]{../../Examples/QuadEdgeMeshSphericalDiffeomorphicDemonsFilter1.cxx}
\end{center}

The Scalar type associated with the nodes in the mesh, and the mesh dimension
are defined in order to declare the Mesh type

\begin{center}
\lstinputlisting[linerange={39-44}]{../../Examples/QuadEdgeMeshSphericalDiffeomorphicDemonsFilter1.cxx}
\end{center}

We declare the type of the registration filter and instantiate it.


\begin{center}
\lstinputlisting[linerange={46-49}]{../../Examples/QuadEdgeMeshSphericalDiffeomorphicDemonsFilter1.cxx}
\end{center}






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  Insert the bibliography using BibTeX
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{plain}
\bibliography{InsightJournal}



\end{document}
